<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE muclient>
<!-- Saved on Saturday, March 22, 2025, 11:13 PM -->
<!-- MuClient version 5.07-pre -->

<!-- Plugin "SmartFighter" generated by Plugin Wizard -->

<muclient>
<plugin
   name="StylishMode"
   author="Bartoc"
   id="4464d1277385ca0637b8cdc3"
   language="Lua"
   purpose="happy"
   save_state="y"
   date_written="2025-03-22 23:12:35"
   requires="5.07"
   version="1.0"
   >

</plugin>


<!--  Triggers  -->

<triggers>
  <trigger
   match="gold coins from the * corpse"
   script="ClearOnDeath"
   enabled="y"
   regexp="y"
   send_to="12"
   sequence="20"
  >
  </trigger>
</triggers>

<!--  Aliases  -->

<!--  Timers  -->

<timers>
  <timer name="qwin_timer" second="1.00" offset_second="0.50"    send_to="12"
group="qwin_timers" >
  <send>update_questtimer()</send>

  </timer>
  <timer name="quest_cooldown_timer" second="1.00" offset_second="0.00"    send_to="12"
group="qwin_timers" >
  <send>update_questcooldown()</send>

  </timer>
  <timer name="gcd" second="2.50" offset_second="0.00"    send_to="12"
group="stylish_mode" >
  <send>TerminateThatShit()</send>

  </timer>
    <timer name="ogcd" second="23" offset_second="0.00"    send_to="12"
group="stylish_mode" >
  <send>OGCD()</send>

  </timer>
</timers>

<!--  Variables  -->

<variables>
  <variable name="drink_container">Sacramental Carafe</variable>
</variables>


<!--  Script  -->


<script>
<![CDATA[
require "aard_register_z_on_create"

require "mw_theme_base"
require "serialize"
require "movewindow"
require "commas"
require "gmcphelper"
require "copytable"

page_built = false
gmcp_char = {}
cached_delay = 0 -- save old speedwalk delay if slowing it down


function TerminateThatShit() 
  FBfighting = gmcp_char.status.enemy
  if FBfighting ~= "" then
   -- AutoPotion()
   ResetTimer("gcd")
    enemypct = ReturnPercent("enemyhp")
    if enemypct <= 15 and enemypct > 0 then
      Send("cast Terminate")
    elseif enemypct >= 30 then
      Send("cast Scourge")
    end
   else
      EnableTimer("gcd", false)
   end
end

function AutoPotion() -- add a potion check before enabling
   if ReturnPercent("mana") < 15 then
      send("drink lotus")
   end
   if ReturnPercent("hp") < 15 then
      send("drink heal")
   end
end

function AutoDrink()
   if character.stats.hunger < 50 or character.stats.thirst < 50 then
      Send("gulp " .. GetVariable("drink_container"))
   end
end

function ReturnPercent(stat)
   if stat == "hp" then
      return tonumber(gmcp_char.vitals.hp)/tonumber(gmcp_char.maxstats.maxhp)
   elseif stat == "hp" then
      return tonumber(gmcp_char.vitals.mana)/tonumber(gmcp_char.maxstats.maxmana)
   elseif stat == "enemyhp" then
      return tonumber(gmcp_char.status.enemypct)
   else
      Note("Bad percentage detected!" .. stat)
      return 100
   end
end

function OGCD() 
  FBfighting = gmcp_char.status.enemy
  if FBfighting ~= "" then
   ResetTimer("OGCD")
    enemypct = tonumber(gmcp_char.status.enemypct)
    Send("flay")
   else
      EnableTimer("OGCD", false)
   end
end

function ClearOnDeath()
   DiscardQueue()
   SetSpeedWalkDelay(0)
   Queue("snap")
end

function OnPluginBroadcast (msg, id, name, text)

   -- Look for GMCP handler.
   if (id == '3e7dedbe37e44942dd46d264') then
      if (text == 'reload') then
         -- invalidate current data
         page_built = false
         return
      end

      if (text == "char.base" or text == "char.vitals" or text == "char.status" or text == "char.maxstats") then
         if text == "char.base" then
            gmcp_char.base = gmcp("char.base")
         elseif text == "char.vitals" then
            gmcp_char.vitals = gmcp("char.vitals")
         elseif text == "char.status" then
            gmcp_char.status = gmcp("char.status")
         else
            gmcp_char.maxstats = gmcp("char.maxstats")
         end
         if gmcp_char.status then
            page_built = true
            AutoDrink()
            EnableTimer("ogcd", true)
            EnableTimer("gcd", true)
         end
      end
   end
end
]]>
</script>


</muclient>
